#!/bin/sh

# Git Push ì•ˆì „ì„± ê²€ì¦ íŒŒì´í”„ë¼ì¸
# 1. ë¸Œëœì¹˜ íŒ¨í„´ ê²€ì‚¬
BRANCH_NAME=$(git symbolic-ref --short HEAD)
if ! echo "$BRANCH_NAME" | grep -Eq '^(main|release|dev|hotfix|feat\/[a-z0-9._-]+|fix\/[a-z0-9._-]+|refactor\/[a-z0-9._-]+|test\/[a-z0-9._-]+|docs\/[a-z0-9._-]+|chore\/[a-z0-9._-]+)$'; then
  echo "ğŸš« ë¸Œëœì¹˜ ì´ë¦„ ì˜ëª» ì‘ì„±í•¨!!"
  echo "ì´ ì¤‘ì— í•˜ë‚˜ë§Œ í—ˆìš©: main, release, dev, hotfix, <type>/<desc>"
  exit 1
fi

# 2. ì½”ë“œ ìŠ¤íƒ€ì¼ ê·œì¹™ ê²€ì¦
echo "Push ì „ ì—„ê²©í•œ Lint ê·œì¹™ ê²€ì¦..."
yarn lint:strict || exit 1

# 3. íƒ€ì… ì•ˆì „ì„± ê²€ì¦
echo "Push ì „ íƒ€ì… ì•ˆì „ì„± ê²€ì¦..."
yarn typecheck || exit 1